<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Product Management</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Add New Product</h1>
    <form id="productForm">
        <label for="name">Product Name:</label>
        <input type="text" id="name" name="name" required><br>

        <label for="description">Description:</label>
        <textarea id="description" name="description" required></textarea><br>

        <label for="price">Price:</label>
        <input type="number" id="price" name="price" required><br>

        <label for="category">Category:</label>
        <select id="category" name="category" required>
            <option value="">Select a category</option>
            <option value="Clothing">Clothing</option>
            <option value="Electronics">Electronics</option>
            <option value="Vegitables">Vegitables</option>
            <option value="Shoe">Shoe</option>
            <option value="Meat">Meat</option>
            <option value="Laptop">Laptop</option>
            <option value="Phones">Phones</option>
            <!-- Add more categories as needed -->
        </select><br>

        <label for="image">Image:</label>
        <input type="file" id="image" name="image" accept="image/*" required><br>

        <button type="submit">Add Product</button>
    </form>

    <button id="submitProductsButton">Submit Products</button>

    <h2>Product List</h2>
    <ul id="productList">
        <!-- Existing products will be listed here -->
    </ul>

    <!-- Display upload message -->
    <div id="uploadMessage"></div>
    <script> 
        document.addEventListener("DOMContentLoaded", function () {
  const productForm = document.getElementById("productForm");
  const productList = document.getElementById("productList");
  const submitProductsButton = document.getElementById("submitProductsButton");
  const uploadMessage = document.getElementById("uploadMessage"); // Get the element where you want to display the upload message

  productForm.addEventListener("submit", function (event) {
    event.preventDefault();

    const name = document.getElementById("name").value;
    const price = document.getElementById("price").value;
    const category = document.getElementById("category").value; // Get category value

    if (name && price && category) {
      const listItem = document.createElement("li");
      listItem.textContent = `${name} - $${price} - Category: ${category}`; // Display category

      const deleteButton = document.createElement("button");
      deleteButton.textContent = "Delete";
      deleteButton.addEventListener("click", function () {
        productList.removeChild(listItem);
      });

      listItem.appendChild(deleteButton);
      productList.appendChild(listItem);

      // Clear input fields after adding product
      document.getElementById("name").value = "";
      document.getElementById("price").value = "";
      document.getElementById("category").value = ""; // Clear category input
    } else {
      alert("Please enter name, price, and category for the product.");
    }
  });

  submitProductsButton.addEventListener("click", function () {
    const products = [];
    const listItems = productList.querySelectorAll("li");

    listItems.forEach(function (listItem) {
      const product = {};
      const [name, price, category] = listItem.textContent.split(" - ");
      product.name = name;
      product.price = parseFloat(price.replace("$", ""));
      product.category = category.split(": ")[1]; // Extract category from the text
      products.push(product);
    });

    // Send products data to server
    sendDataToServer(products);
  });

  function sendDataToServer(products) {
    fetch("http://localhost:3000/products", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify(products),
    })
      .then((response) => {
        if (!response.ok) {
          throw new Error("Network response was not ok");
        }
        return response.text();
      })
      .then((data) => {
        console.log("Server response:", data);
        // Show upload message
        uploadMessage.textContent = "Data uploaded successfully!";
      })
      .catch((error) => {
        console.error("Error submitting products:", error);
        // Optionally, you can handle errors that occur during the submission process
      });
  }
});

    </script>


</body>
</html>
